<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link href="./style.css" rel="stylesheet">

    <title>AD Users Export</title>
  </head>
  <body>
    <h1>Export Users from an AD</h1>

    <div class="bd-callout">
      <strong>Steps to get a brut export of an AD</strong></br>
        1. Open a powershell on the Active Directory</br>
        2. Run the command: <code>Get-ADUser -Filter * -Properties * | Select * | Out-File -FilePath ((Get-Location | Select -ExpandProperty Path) + "\" + "exported_users.csv")</code></br>
        3. Upload bellows the file "exported_users.csv" generated by the command</br>
        4. Click the button "Get CSV format bellow
    </div>

    <div id="uploadSection">
      <input type="file" class="form-control uploadElements" id="brutFile"/>
      <button type="button" class="btn btn-dark uploadElements" onclick="readFile()">
        Get CSV format
      </button>
    </div>
    <p><strong>Note:</strong> If the reformated file is wrong, please verify that the file generated should be in UTF-16</p>

    <div class="footer">&copy; 2021, Ugo Reyne in Lyvoc</div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
    <script src="./script.js"></script>
  </body>
</html>